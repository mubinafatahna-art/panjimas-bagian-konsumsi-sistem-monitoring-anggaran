<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Konsumsi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; }
        .navbar { background-color: #2c3e50 !important; }
        .card { border: none; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .btn-primary { background-color: #3498db; border: none; }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark mb-4">
        <div class="container">
            <span class="navbar-brand mb-0 h1">Dashboard Tim Konsumsi</span>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card p-4">
                    <h5 class="mb-3">Input Pengeluaran</h5>
                    <form id="notaForm">
                        <div class="mb-2">
                            <label class="small text-muted">Nama Pelapor</label>
                            <select id="nama" class="form-select" required>
                                <option value="Anggota 1">Anggota 1</option>
                                <option value="Anggota 2">Anggota 2</option>
                                <option value="Anggota 3">Anggota 3</option>
                                <option value="Anggota 4">Anggota 4</option>
                            </select>
                        </div>
                        <div class="mb-2">
                            <label class="small text-muted">Barang / Keperluan</label>
                            <input type="text" id="keperluan" class="form-control" placeholder="Contoh: Aqua 2 Dus" required>
                        </div>
                        <div class="mb-3">
                            <label class="small text-muted">Total Nominal (Rp)</label>
                            <input type="number" id="nominal" class="form-control" placeholder="Hanya angka" required>
                        </div>
                        <button type="submit" id="btnKirim" class="btn btn-primary w-100">Kirim Data</button>
                    </form>
                </div>
            </div>

            <div class="col-md-8">
                <div class="card p-4">
                    <h5 class="mb-3">Riwayat Penggunaan Dana</h5>
                    <div class="table-responsive">
                        <table class="table table-striped small">
                            <thead>
                                <tr>
                                    <th>Tanggal</th>
                                    <th>Oleh</th>
                                    <th>Keperluan</th>
                                    <th>Nominal</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="tabelBody">
                                <tr><td colspan="5" class="text-center">Memuat data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // MASUKKAN URL GOOGLE SCRIPT ANDA DI SINI
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzDbFMM0mUjdnpoHzFLOT0wMiBS7NFBAze-IB3iFrclfoludl_0T957J2fvLyWbtdOT/exec";

        // Fungsi Simpan Data
        document.getElementById('notaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const btn = document.getElementById('btnKirim');
            btn.innerHTML = "Mengirim...";
            btn.disabled = true;

            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify({
                    nama: document.getElementById('nama').value,
                    keperluan: document.getElementById('keperluan').value,
                    nominal: document.getElementById('nominal').value,
                    nota: "-"
                })
            }).then(res => {
                alert('Data Berhasil Disimpan!');
                location.reload();
            }).catch(err => alert('Gagal: ' + err));
        });

        // Fungsi Ambil Data
        fetch(SCRIPT_URL)
            .then(res => res.json())
            .then(data => {
                let html = "";
                for(let i = 1; i < data.length; i++) {
                    html += `<tr>
                        <td>${new Date(data[i][0]).toLocaleDateString('id-ID')}</td>
                        <td>${data[i][1]}</td>
                        <td>${data[i][2]}</td>
                        <td>Rp ${Number(data[i][3]).toLocaleString('id-ID')}</td>
                        <td><span class="badge ${data[i][5] == 'Pending' ? 'bg-warning' : 'bg-success'}">${data[i][5]}</span></td>
                    </tr>`;
                }
                document.getElementById('tabelBody').innerHTML = html;
            });
    </script>
</body>
</html>
